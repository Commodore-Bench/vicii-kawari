#!/bin/bash


# if golden is 1, will create all golden masters for tests
# that use comparisons
GOLDEN=$1

# Discover available test numbers from .cpp files
TESTS=`ls tests/test[0-9]*.cpp | sed 's/tests.test//' | sed 's/.cpp//'`
# Do all chips for every test
CHIPS="0 1 2"


for n in $TESTS
do
   for c in $CHIPS
   do
      if [ "$GOLDEN" = "1" ]
      then
         vicsim -r $n -c $c -l4 -g > tests/test${n}_c${c}.log
      else
	 # Do both with and without reset at start
         vicsim -r $n -c $c -l3
         vicsim -j -r $n -c $c -l3
      fi
   done
done
